<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Vidcuy - Smooth Neon Hosting</title>
  <meta name="description" content="Vidcuy: Free video hosting with smooth, flickering neon blue aesthetic and progress bar.">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css"
    integrity="sha512-1ycn6IcaQQ40/MKBW2W4Rhis/DbILU74C1vSrLJxCq57o941Ym01SwNsOMqvEBFlcgUa6xLiPY/NS5R+E6ztJQ=="
    crossorigin="anonymous"
    referrerpolicy="no-referrer" />

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">

  <style>
    /* --- BASE & VARIABLES --- */
    :root {
      --bg-dark: #0a0f1f;
      --text-dark: #e8e8f0;
      --text-muted: #a0a0b0;
      --primary-neon: #00bfff;
      --primary-neon-darker: #009acd;
      --navbar-bg: rgba(5, 10, 25, 0.85);
      --footer-bg: #030610;
      --shadow-color-neon: rgba(0, 191, 255, 0.7);
      --shadow-color-neon-flicker: rgba(0, 191, 255, 0.9);
      --shadow-color-dark: rgba(0, 0, 0, 0.6);
      --border-color: #2a3a59;
      --border-color-neon: rgba(0, 191, 255, 0.5);
      --progress-bar-bg: rgba(42, 58, 89, 0.7);

      --font-main: 'Roboto', sans-serif;
      --transition-speed: 0.3s; /* Default smooth transition speed */
      --transition-speed-fast: 0.15s; /* Faster for clicks */
      --timing-function-smooth: ease-out; /* Smoother easing */
    }

    html {
      font-family: var(--font-main); scroll-behavior: smooth; box-sizing: border-box;
    }
    *, *:before, *:after { box-sizing: inherit; }

    /* --- THEME --- */
    body {
      margin: 0; background-color: var(--bg-dark); color: var(--text-dark);
      line-height: 1.6; padding-bottom: 80px; font-weight: 400;
    }
    a {
      color: var(--primary-neon); text-decoration: none;
      transition: color var(--transition-speed) var(--timing-function-smooth),
                  filter var(--transition-speed) var(--timing-function-smooth);
    }
    a:hover { color: var(--primary-neon); filter: brightness(1.3); }

    /* --- NAVBAR --- */
    .nav-outer {
      display: flex; align-items: center; justify-content: center; background-color: var(--navbar-bg);
      backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px); min-height: 65px;
      padding: 0 20px; position: sticky; top: 0; z-index: 1000;
      transition: background-color var(--transition-speed) var(--timing-function-smooth),
                  border-color var(--transition-speed) var(--timing-function-smooth);
      border-bottom: 1px solid var(--border-color-neon);
      box-shadow: 0 0 15px var(--shadow-color-neon), 0 3px 10px var(--shadow-color-dark);
      animation: flicker-border-shadow 3s infinite alternate;
    }
    .nav-inner { width: 100%; max-width: 1200px; display: flex; align-items: center; }
    .logo-text {
      font-size: 28px; font-weight: 700; letter-spacing: -0.5px; color: var(--primary-neon);
      margin-right: 30px;
      transition: transform var(--transition-speed) var(--timing-function-smooth);
      animation: flicker-text-glow 2.5s infinite alternate;
    }
    .logo-text a { color: inherit; text-decoration: none; }
    .logo-text:hover { transform: scale(1.03); }
    .nav-menu { display: flex; align-items: center; margin-left: auto; gap: 25px; }
    .upload-button-nav {
      background: linear-gradient(45deg, var(--primary-neon), var(--primary-neon-darker));
      border: none; border-radius: 6px; font-size: 16px; font-weight: 500;
      padding: 11px 20px; color: #030610; cursor: pointer;
      transition: transform var(--transition-speed-fast) var(--timing-function-smooth),
                  box-shadow var(--transition-speed) var(--timing-function-smooth),
                  filter var(--transition-speed) var(--timing-function-smooth);
      text-decoration: none; display: flex; align-items: center; justify-content: center;
      box-shadow: 0 0 8px var(--shadow-color-neon), 0 0 15px var(--shadow-color-neon) inset;
    }
    .upload-button-nav i { margin-right: 8px; }
    .upload-button-nav:hover {
      transform: translateY(-2px) scale(1.03);
      box-shadow: 0 0 12px var(--shadow-color-neon), 0 0 25px var(--shadow-color-neon) inset, 0 4px 15px rgba(0,0,0,0.4);
      filter: brightness(1.1);
    }
    .legal-links { display: flex; gap: 25px; }
    .legal-links a {
      color: var(--text-muted); font-size: 15px; font-weight: 400; position: relative;
      padding-bottom: 4px;
      transition: color var(--transition-speed) var(--timing-function-smooth);
    }
    .legal-links a::after {
        content: ''; position: absolute; width: 0; height: 2px; bottom: 0; left: 50%;
        transform: translateX(-50%); background-color: var(--primary-neon);
        transition: width var(--transition-speed) var(--timing-function-smooth);
        box-shadow: 0 0 5px var(--shadow-color-neon); opacity: 0.7;
    }
    .legal-links a:hover { color: var(--text-dark); filter: none; }
    .legal-links a:hover::after { width: 100%; }

    /* --- MOBILE MENU --- */
    .hamburger {
      display: none; font-size: 26px; cursor: pointer; color: var(--primary-neon);
      transition: transform var(--transition-speed-fast) var(--timing-function-smooth),
                  color var(--transition-speed) var(--timing-function-smooth),
                  text-shadow var(--transition-speed) var(--timing-function-smooth);
      text-shadow: 0 0 6px var(--shadow-color-neon); z-index: 1001;
    }
    .hamburger:hover { transform: scale(1.15); color: #fff; text-shadow: 0 0 10px var(--shadow-color-neon); }
    #mobile-menu {
      display: none; flex-direction: column; background-color: var(--navbar-bg);
      backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px);
      position: absolute; top: 65px; left: 0; width: 100%; border-top: 1px solid var(--border-color);
      padding: 10px 0; z-index: 999; box-shadow: 0 8px 20px var(--shadow-color-dark);
      opacity: 0; transform: translateY(-15px);
      transition: opacity var(--transition-speed) var(--timing-function-smooth),
                  transform var(--transition-speed) var(--timing-function-smooth);
    }
    #mobile-menu.active { display: flex; opacity: 1; transform: translateY(0); }
    #mobile-menu a {
      padding: 15px 25px; font-size: 17px; font-weight: 500; color: var(--text-dark);
      text-decoration: none;
      transition: background-color var(--transition-speed-fast) var(--timing-function-smooth),
                  color var(--transition-speed-fast) var(--timing-function-smooth);
      border-bottom: 1px solid rgba(42, 58, 89, 0.5);
    }
    #mobile-menu a:last-child { border-bottom: none; }
    #mobile-menu a:hover { background-color: rgba(0, 191, 255, 0.1); color: var(--primary-neon); filter: brightness(1.2); }

    /* --- RESPONSIVE --- */
    @media (max-width: 768px) {
      .nav-menu { gap: 20px; }
      .legal-links, .upload-button-nav { display: none; }
      .hamburger { display: block; margin-left: auto; }
      .nav-outer { animation-duration: 3.5s; }
      .logo-text { animation-duration: 3s; }
    }
     @media (max-width: 480px) {
        .logo-text { font-size: 24px; margin-right: 15px; }
        .nav-outer { padding: 0 15px; }
        .hamburger { font-size: 24px; }
     }

    /* --- MAIN CONTENT --- */
    .body { padding: 50px 20px; max-width: 1100px; margin: 0 auto; }
    .main-area {
      padding-top: 60px; display: flex; flex-direction: column;
      align-items: center; text-align: center;
    }
    .headline {
      font-weight: 700; font-size: clamp(2.2rem, 6vw, 4rem); margin-bottom: 25px;
      color: var(--primary-neon);
      text-shadow: 0 0 10px var(--shadow-color-neon), 0 0 20px var(--shadow-color-neon);
      animation: pulse-glow 4s infinite alternate ease-in-out;
    }
    .description {
      font-size: clamp(1.1rem, 3vw, 1.35rem); margin-bottom: 45px; max-width: 700px;
      color: var(--text-muted); line-height: 1.7; font-weight: 300;
    }

    /* Upload Status Area */
    .upload-status {
       display: none; /* Hidden by default */
       width: 100%; max-width: 500px; margin-top: 20px;
    }
    .headline-uploading {
      font-weight: 500; font-size: clamp(1.8rem, 4vw, 2.8rem);
      color: var(--primary-neon); text-shadow: 0 0 10px var(--shadow-color-neon);
      margin-bottom: 25px;
    }
    .progress-bar-container {
        width: 100%; height: 12px; background-color: var(--progress-bar-bg);
        border-radius: 6px; overflow: hidden; border: 1px solid var(--border-color);
        box-shadow: inset 0 1px 3px rgba(0,0,0,0.4); margin-bottom: 15px;
    }
    .progress-bar {
        width: 0%; height: 100%;
        background: linear-gradient(90deg, var(--primary-neon-darker), var(--primary-neon));
        border-radius: 6px;
        transition: width var(--transition-speed) var(--timing-function-smooth);
        box-shadow: 0 0 8px var(--shadow-color-neon);
    }
    #processing-percentage {
        display: none; /* Initially hidden, shown during upload */
        font-size: clamp(0.9rem, 2vw, 1.1rem); color: var(--text-muted);
        margin-top: 10px; font-weight: 400;
    }
     #processing-percentage span { color: var(--primary-neon); font-weight: 500; }

    /* Main Upload Button */
    .upload-button {
      min-width: 180px; padding: 18px 35px;
      background: linear-gradient(45deg, var(--primary-neon), var(--primary-neon-darker));
      border: none; border-radius: 8px; font-weight: 700; font-size: 20px;
      margin: 30px auto 0; display: inline-flex; align-items: center; justify-content: center;
      color: #030610; cursor: pointer;
      transition: transform 0.25s cubic-bezier(0.175, 0.885, 0.32, 1.275),
                  box-shadow var(--transition-speed) var(--timing-function-smooth),
                  filter var(--transition-speed) var(--timing-function-smooth);
      box-shadow: 0 0 12px var(--shadow-color-neon), 0 0 25px var(--shadow-color-neon) inset, 0 5px 10px rgba(0,0,0,0.3);
      /* Added for visibility control */
      visibility: visible;
    }
    .upload-button i { margin-right: 10px; font-size: 1.1em; }
    .upload-button:hover {
      transform: scale(1.08) translateY(-3px);
      box-shadow: 0 0 18px var(--shadow-color-neon), 0 0 40px var(--shadow-color-neon) inset, 0 8px 20px rgba(0,0,0,0.5);
      filter: brightness(1.15);
    }

    /* --- FOOTER --- */
    footer {
      padding: 20px 0; text-align: center; font-size: 14px; color: var(--text-muted);
      position: fixed; bottom: 0; left: 0; width: 100%; background-color: var(--footer-bg);
      z-index: 998; border-top: 1px solid var(--border-color-neon);
      box-shadow: 0 0 10px var(--shadow-color-neon);
      animation: flicker-border-shadow 3.5s infinite alternate-reverse;
    }
    footer p { margin: 0; font-weight: 300; }

    /* --- ANIMATIONS --- */
    .animate-click {
      transform: scale(0.96) !important;
      filter: brightness(0.9) !important;
      transition: transform var(--transition-speed-fast) var(--timing-function-smooth),
                  filter var(--transition-speed-fast) var(--timing-function-smooth) !important;
    }
    @keyframes pulse-glow { /* Headline */
        0%, 100% { text-shadow: 0 0 8px var(--shadow-color-neon), 0 0 15px var(--shadow-color-neon); opacity: 0.9; }
        50% { text-shadow: 0 0 12px var(--shadow-color-neon), 0 0 25px var(--shadow-color-neon); opacity: 1; }
    }
    @keyframes flicker-text-glow { /* Logo */
      0%, 100% { text-shadow: 0 0 7px var(--shadow-color-neon), 0 0 12px var(--shadow-color-neon), 0 0 2px var(--primary-neon); opacity: 1; }
      10%, 30%, 60%, 90% { text-shadow: 0 0 5px var(--shadow-color-neon), 0 0 8px var(--shadow-color-neon); opacity: 0.85; }
      20%, 70% { text-shadow: 0 0 9px var(--shadow-color-neon-flicker), 0 0 16px var(--shadow-color-neon-flicker), 0 0 3px var(--primary-neon); opacity: 1; }
      40%, 80% { text-shadow: none; opacity: 0.7; }
      50% { text-shadow: 0 0 7px var(--shadow-color-neon), 0 0 12px var(--shadow-color-neon); opacity: 1; }
    }
    @keyframes flicker-border-shadow { /* Nav/Footer */
       0%, 100% { border-color: var(--border-color-neon); box-shadow: 0 0 10px var(--shadow-color-neon), 0 3px 8px var(--shadow-color-dark); opacity: 1; }
       15%, 45%, 90% { border-color: rgba(0, 191, 255, 0.4); box-shadow: 0 0 6px rgba(0, 191, 255, 0.4), 0 2px 6px var(--shadow-color-dark); opacity: 0.8; }
       30%, 75% { border-color: var(--border-color-neon); box-shadow: 0 0 18px var(--shadow-color-neon-flicker), 0 4px 12px var(--shadow-color-dark); opacity: 1; }
       60% { border-color: var(--border-color); box-shadow: 0 2px 5px var(--shadow-color-dark); opacity: 0.6; }
    }

    /* --- UTILITY --- */
    .hidden { display: none !important; }
    /* Dragging style */
    body.dragging { outline: 3px dashed var(--primary-neon); outline-offset: -10px; }
  </style>
</head>
<body>
  <div class="nav-outer">
    <div class="nav-inner">
      <div class="logo-text"><a href="/">Vidcuy</a></div>
      <div class="nav-menu">
         <a href="#" class="upload-button-nav button-click" onclick="handleClick(); return false;"><i class="fas fa-upload"></i>Upload</a> <div class="legal-links">
          <a href="#">Privacy Policy</a> <a href="#">Terms</a> <a href="#">Abuse</a> </div>
      </div>
      <div class="hamburger button-click" onclick="toggleMobileNavbar()"><i class="fa fa-bars"></i></div>
    </div>
  </div>

  <div id="mobile-menu">
     <a href="#" onclick="handleClick(); toggleMobileNavbar(); return false;">Upload</a>
    <a href="#">Privacy Policy</a>
    <a href="#">Terms of Service</a>
    <a href="#">Abuse</a>
  </div>

  <div class="body">
    <form action="/api/upload" method="POST" id="form" style="display: none;">
      <input name="file" type="file" id="selectedFile" accept="video/*" />
    </form>

    <div class="main-area">
      <div class="headline">Vidcuy Video Hosting</div>
      <div class="description">Free, simple, and dazzlingly fast. Just select or drop your video file.</div>

      <div class="upload-status">
          <div class="headline-uploading">Uploading...</div>
          <div class="progress-bar-container">
              <div class="progress-bar" id="progressBar"></div>
          </div>
          <div id="processing-percentage">0% Uploaded</div>
      </div>

      <div class="upload-button button-click" onclick="handleClick();">
        <i class="fas fa-folder-open"></i> Browse File
      </div>
    </div>
  </div>

  <footer>
    <p>Â© PanzNgen. All rights reserved.</p>
  </footer>

  <script
    src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"
    integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ=="
    crossorigin="anonymous"
    referrerpolicy="no-referrer">
  </script>

  <script>
    // Fungsi dasar UI (Mobile Menu, Animasi Klik)
    function toggleMobileNavbar() {
      document.getElementById("mobile-menu").classList.toggle("active");
    }

    document.querySelectorAll('.button-click').forEach(function(button) {
      button.addEventListener('mousedown', function() { this.classList.add('animate-click'); });
      const removeAnimation = () => { setTimeout(() => button.classList.remove('animate-click'), 100); };
      button.addEventListener('mouseup', removeAnimation);
      button.addEventListener('mouseleave', () => { if (button.classList.contains('animate-click')) { button.classList.remove('animate-click'); } });
    });

    // Fungsi untuk memicu klik input file
    function handleClick() {
      // Cek jika elemen ada sebelum diklik
      if ($("#selectedFile").length > 0) {
           $("#selectedFile").click();
      } else {
           console.error("Element #selectedFile not found.");
      }
    }

    // --- LOGIKA UNGGAH SEBENARNYA ---
    let target = document.documentElement;
    let body = document.body;
    let fileInput = document.getElementById("selectedFile"); // Dapatkan elemen input file

    // Pastikan fileInput ada sebelum menambahkan listener
    if (fileInput) {
        // Gunakan event listener agar tidak menimpa event lain jika ada
        fileInput.addEventListener('change', function() {
            upload(); // Panggil fungsi upload saat file dipilih
        });
    } else {
        console.error("Element #selectedFile not found during event listener setup.");
    }

    target.addEventListener('dragover', (e) => {
        // Hanya aktifkan jika tombol upload terlihat (belum mengupload)
        if ($(".upload-button").css('visibility') === 'visible') {
            e.preventDefault();
            body.classList.add('dragging');
        }
    });

    target.addEventListener('dragleave', () => {
        body.classList.remove('dragging');
    });

    target.addEventListener('drop', (e) => {
         if ($(".upload-button").css('visibility') === 'visible') {
            e.preventDefault();
            body.classList.remove('dragging');
            if (fileInput && e.dataTransfer.files.length > 0) { // Pastikan ada file yang di-drop
               fileInput.files = e.dataTransfer.files;
               upload(); // Panggil fungsi upload
            }
        }
    });

    window.addEventListener('paste', e => {
        if (fileInput && $(".upload-button").css('visibility') === 'visible') {
             // Cek apakah ada file di clipboardData
             if (e.clipboardData && e.clipboardData.files && e.clipboardData.files.length > 0) {
                 fileInput.files = e.clipboardData.files;
                 upload(); // Panggil fungsi upload
             }
        }
    });

    // Fungsi upload yang sebenarnya menggunakan AJAX
    function upload() {
        // Ambil elemen lagi di dalam fungsi untuk memastikan referensi terbaru
        var currentFileInput = document.getElementById('selectedFile');
        var formElement = document.getElementById('form');

        // Validasi dasar
        if (!currentFileInput || !formElement || !currentFileInput.files || currentFileInput.files.length === 0) {
             console.log("No file selected or form element missing.");
             return; // Hentikan fungsi jika tidak ada file
        }

        var formData = new FormData(formElement);

        // Update UI untuk menunjukkan proses upload
        $(".headline").hide();
        $(".description").hide();
        $(".upload-button").css('visibility', 'hidden'); // Sembunyikan tombol upload
        $(".upload-status").show(); // Tampilkan area status
        $(".headline-uploading").text("Uploading..."); // Set teks judul status
        $("#progressBar").css('width', '0%'); // Reset progress bar
        $("#processing-percentage").text("0% Uploaded").show(); // Tampilkan & reset teks persentase

        $.ajax({
            xhr: function() {
                var xhr = new window.XMLHttpRequest();
                xhr.upload.addEventListener("progress", function(evt) {
                    if (evt.lengthComputable) {
                        var percentComplete = Math.round((evt.loaded / evt.total) * 100);
                        $("#progressBar").css('width', percentComplete + '%');
                        $("#processing-percentage").html(`<span>${percentComplete}%</span> Uploaded`);

                        if (percentComplete === 100) {
                            $(".headline-uploading").text("Processing...");
                            $("#processing-percentage").html("Finalizing upload...");
                        }
                    }
                }, false);
                return xhr;
            },
            url: '/api/upload', // PASTIKAN URL INI BENAR SESUAI SERVER ANDA
            type: 'POST',
            context: this,
            data: formData,
            cache: false,
            contentType: false,
            processData: false,
            success: function (result) {
                // DEBUGGING LOGS (PENTING!)
                console.log("AJAX Success triggered.");
                console.log("Server response (result):", result);

                // Cek respons server & lakukan redirect
                if (result && result.id) {
                     console.log("Result and result.id found. ID:", result.id);
                     console.log("Attempting redirect to:", "/v?id=" + result.id);
                     window.location.href = "/v?id=" + result.id; // GO TO VIDEO PAGE
                } else {
                     // Handle jika response sukses tapi format salah atau tidak ada ID
                     console.error("Condition (result && result.id) failed.");
                     console.error("Upload successful, but no video ID received or result format incorrect.");
                     alert("Upload successful, but failed to get video link. Please check console or try again.");
                     // Kembalikan UI ke state awal jika gagal redirect
                     $(".headline").show();
                     $(".description").show();
                     $(".upload-button").css('visibility', 'visible');
                     $(".upload-status").hide();
                     $("#form")[0].reset(); // Reset form agar bisa upload lagi
                }
            },
            error: function (jqXHR, textStatus, errorThrown) {
                // Handle jika terjadi error koneksi atau server error (status bukan 2xx)
                console.error("AJAX Error occurred.");
                console.error("Status:", textStatus);
                console.error("Error:", errorThrown);
                console.error("Response Text:", jqXHR.responseText); // Lihat detail error jika ada
                alert("Upload failed due to a server or network error. Please try again.");
                // Kembalikan UI ke state awal
                $(".headline").show();
                $(".description").show();
                $(".upload-button").css('visibility', 'visible');
                $(".upload-status").hide();
                $("#form")[0].reset();
            }
        });
    }
  </script>

</body>
</html>
